
<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-siteapp"/>
  <title>首页</title>


  <link rel="stylesheet" href="/static/MDUI/css/mdui.min.css">
  <!--<script src="/static/MDUI/js/mdui.min.js"></script>-->
  <link rel="stylesheet" href="/static/MDUI/css/doc.css">

  <script type="text/javascript" src="/static/js/lib/vue.js"></script>
  <script src="/static/js/lib/jquery/jquery-2.1.4.min.js"></script>

  <script src="/static/base/base.js"></script>
  

</head>
<body class="mdui-drawer-body-left mdui-appbar-with-toolbar  mdui-theme-primary-indigo mdui-theme-accent-pink">
<header class="mdui-appbar mdui-appbar-fixed">
  <div class="mdui-toolbar mdui-color-theme">
    <span class="mdui-btn mdui-btn-icon mdui-ripple mdui-ripple-white" mdui-drawer="{target: '#main-drawer', swipe: true}"><i class="mdui-icon material-icons">menu</i></span>
    <a href="index.html" class="mdui-typo-headline mdui-hidden-xs">NEWS</a>
          <a href="color.html" class="mdui-typo-title">首页</a>
        <div class="mdui-toolbar-spacer"></div>
  </div>
</header>

<div class="mdui-drawer" id="main-drawer">
  <div class="mdui-list" mdui-collapse="{accordion: true}" style="margin-bottom: 76px;">
    <div class="mdui-collapse-item mdui-collapse-item-open">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">near_me</i>
        <div class="mdui-list-item-content">后台管理</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list">
        <a href="index.html" class="mdui-list-item mdui-ripple mdui-list-item-active">属性管理</a>
        <a href="compatibility.html" class="mdui-list-item mdui-ripple ">兼容性</a>
        <a href="jq.html" class="mdui-list-item mdui-ripple ">JavaScript 工具库</a>
        <a href="global.html" class="mdui-list-item mdui-ripple ">JavaScript 全局方法</a>
      </div>
    </div>
  </div>

</div>

<a id="anchor-top"></a>

<style>
  .color-palette{
    position: relative;
    padding: 0 0 36px 0;
    margin: 0;
    list-style: none;
    font-weight: 500;
    font-size: 14px;
  }
  .color-palette li {
    padding: 15px;
  }
  .color-palette .color-divider {
    margin-top: 8px;
  }
  .color-palette .main-color {
  }
  .color-palette .main-color .color-name {
    display: block;
    margin-bottom: 60px;
  }
  .color-palette .color-hex {
    float: right;
    text-transform: uppercase;
  }
  .color-palette .anchor-primary-color {
    position: absolute;
    top: -72px;
  }
  .color-palette .anchor-accent-color {
    position: absolute;
    top: 520px;
  }
</style>

<div class="mdui-container doc-container doc-no-cover">
  <h1 class="doc-title mdui-text-color-theme">属性管理</h1>

    <div class="mdui-row" id="property">
        <div class="mdui-col-xs-3">
            <h3 class="doc-title mdui-text-color-theme">属性组</h3>
            <ul class="mdui-list" v-for="(propertyGroup,index) in propertyGroupList">
                <li class="mdui-list-item mdui-ripple"
                    v-on:click="getProperty(index,propertyGroup.gid)"
                    v-bind:class="{'mdui-list-item-active':index==active}"
                >
                    {{propertyGroup.groupName}}
                </li>
                <li class="mdui-divider"></li>
            </ul>
        </div>
        <div class="mdui-col-xs-9">
            <div class="mdui-col-xs-9">
                <h3 class="doc-title mdui-text-color-theme">属性</h3>
            </div>
            <div class="mdui-col-xs-3">
                <h3 class="doc-title mdui-text-color-theme">
                    <button class="mdui-btn mdui-btn-icon mdui-btn-dense mdui-btn-raised mdui-color-theme-accent mdui-ripple mdui-center" mdui-dialog="{target: '#addProperty'}">
                        <i class="mdui-icon material-icons">add</i>
                    </button>
                </h3>
            </div>
           <!-- <ul class="mdui-list" v-for="(property,index) in propertyList">
                <li class="mdui-list-item mdui-ripple">
                    {{property.propertyName}}
                </li>
                <li class="mdui-divider"></li>
            </ul>-->
            <div class="mdui-table-fluid">
                <table class="mdui-table mdui-table-hoverable">
                    <thead>
                    <tr>
                        <th>序号</th>
                        <th>属性名</th>
                        <th>属性code</th>
                        <th>操作</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr v-for="(property,index) in propertyList">
                        <td>{{index+1}}</td>
                        <td>{{property.propertyName}}</td>
                        <td>{{property.propertyKey}}</td>
                        <td>
                            <button class="mdui-btn mdui-btn-dense mdui-btn-raised mdui-ripple mdui-color-theme-accent"
                                    v-on:click="delProperty(index,property.gid)">
                                删除
                            </button>
                        </td>
                    </tr>


                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div>
    <div class="mdui-dialog" id="spinner">
        <div class="mdui-dialog-title">正在执行</div>
        <div class="mdui-dialog-content" style="text-align: center">
            正在执行，请稍候...
            <div class="mdui-spinner mdui-spinner-colorful"></div>
        </div>
    </div>

    <div class="mdui-dialog" id="addProperty">
        <div class="mdui-dialog-title">添加属性</div>
        <div class="mdui-dialog-content" >
            <div class="mdui-textfield mdui-textfield-floating-label">
                <label class="mdui-textfield-label">property_key</label>
                <input class="mdui-textfield-input" />
            </div>
            <div class="mdui-textfield mdui-textfield-floating-label">
                <label class="mdui-textfield-label">property_name</label>
                <input class="mdui-textfield-input" />
            </div>
            <!-- 浮动标签 -->
            <div class="mdui-textfield mdui-textfield-floating-label">
                <label class="mdui-textfield-label">Message</label>
                <textarea class="mdui-textfield-input"></textarea>
            </div>

            <div class="mdui-textfield mdui-textfield-floating-label">
                <label class="mdui-textfield-label">extra1</label>
                <input class="mdui-textfield-input" />
            </div>
            <div class="mdui-textfield mdui-textfield-floating-label">
                <label class="mdui-textfield-label">extra2</label>
                <input class="mdui-textfield-input" />
            </div>
            <div class="mdui-textfield mdui-textfield-floating-label">
                <label class="mdui-textfield-label">extra3</label>
                <input class="mdui-textfield-input" />
            </div>
            <div class="mdui-textfield mdui-textfield-floating-label">
                <label class="mdui-textfield-label">extra4</label>
                <input class="mdui-textfield-input" />
            </div>
        </div>
        <div class="mdui-dialog-actions">
            <button class="mdui-btn mdui-ripple">确定</button>
            <button class="mdui-btn mdui-ripple" mdui-dialog-close>取消</button>
        </div>
    </div>

</div>

<script src="/static/MDUI/js/mdui.min.js"></script>

<script>

    //进度指示器
    var dialogOptions = {
        modal : true,
        closeOnEsc : false,
    }
    var spinner = new mdui.Dialog('#spinner',dialogOptions);



    Vue.config.debug = true;//开启vue的debug模式
    var vm = new Vue({
                         el:"#property",
                         data : {
                             propertyGroup : {
                                 gid:'',
                                 groupCode:'',
                                 groupKey:'',
                                 groupName:''
                             },
                             propertyGroupList:[],
                             property : {
                                 gid:'',
                                 propertyKey:'',
                                 propertyName:'',
                                 groupKey:'',
                             },
                             propertyList:[],
                             active:'-1'


                         },
                         // 初始化执行
                         mounted(){
                             this.queryPropertyGroup()
                         },
                         methods : {

                             queryPropertyGroup: function () {
                                 $.ajax({
                                            type : "post",
                                            url : "/adminC/queryPropertyGroup",
                                            //data : JSON.stringify(test3.page),
                                            datatype : 'json',
                                            contentType:"application/json",
                                            success : function(data) {
                                                //console.log(JSON.stringify(data))
                                                if(data.success == true){
                                                    vm.propertyGroupList = data.obj;
                                                }else{
                                                    mdui.alert(data.message);
                                                }
                                            },
                                            error : function() {
                                                mdui.alert("请求失败");
                                            }
                                        });
                             },
                             getProperty: function (index,gid) {
                                 //console.log(event.currentTarget);
                                 //添加选中状态
                                 this.active=index;

                                 //通过id查询属性
                                 $.ajax({
                                            type : "post",
                                            url : "/adminC/queryProperty",
                                            data : "id="+gid,
                                            success : function(data) {
                                                //console.log(vm.parent.success);
                                                //console.log(vm.isTest);
                                                if(data.success == true){
                                                    vm.propertyList = data.obj;
                                                    console.log(vm.propertyList);
                                                }else{
                                                    mdui.alert(data.message);
                                                }
                                            },
                                            error : function() {
                                                console.log("请求失败");
                                            }
                                        });
                             },
                             delProperty: function (index,gid) {
                                 //console.log(event.currentTarget);

                                 // 含文本和确认回调
                                 mdui.confirm('确认删除？！', function(){
                                     spinner.open();
                                     /*setTimeout(function(){
                                         spinner.close();
                                     }, 1000);*/
                                     console.log(spinner.getState());
                                     document.getElementById('spinner').addEventListener('opened.mdui.dialog', function () {
                                         console.log(spinner.getState());
                                         //通过id删除属性
                                         $.ajax({
                                                    type : "post",
                                                    url : "/adminC/delProperty",
                                                    data : "id="+gid,
                                                    async: false,
                                                    success : function(data) {
                                                        //console.log(vm.parent.success);
                                                        //console.log(vm.isTest);
                                                        if(data.success == true){
                                                            vm.propertyList.splice(index,1);
                                                        }else{
                                                            mdui.alert(data.message);
                                                        }
                                                        console.log(spinner.getState());
                                                        spinner.toggle();
                                                    },
                                                    error : function() {
                                                        mdui.alert("请求失败");
                                                        spinner.close();
                                                    }
                                                });
                                     });
                                 });



                             }
                         }
                     });




    /*$(function(){
        $.ajax({
                   type : "post",
                   url : "/userC/validateUserLogin",
                   data : "token="+token,
                   success : function(data) {
                       //console.log(vm.parent.success);
                       //console.log(vm.isTest);
                       if(data.success != true){
                           location.href = "../login.html";
                       }
                   },
                   error : function() {
                       console.log("请求失败");
                   }
               });
    });*/

</script>

